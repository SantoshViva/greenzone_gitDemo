#Default operator Id
QUERY_INBOX_USER_ID=select * from (select * from tb_chat_messages where friendMsisdn='{msisdn}' order by id desc) as t group by msisdn order by id desc
SQL2_MYCHAT_MESSAGE_DETAILS=select * from tb_chat_messages_history_{table_index}  where msisdn ='{msisdn}' and  friendMsisdn='{friendMsisdn}' order by chat_read_date  desc limit 0,8
SQL3_MYFRIENDCHAT_MESSAGE_DETAILS=select * from tb_chat_messages_history_{table_index}  where msisdn ='{friendMsisdn}' and  friendMsisdn='{msisdn}' order by chat_read_date  desc limit 0,8
SQL4_TODAY_USER_ID= select ano.todayUserId, ano.todayMsisdn from tb_chat_today_special_userId_{table_index} ano, tb_subscriptions_{table_index} sub where ano.msisdn = '{msisdn}' and ano.msisdn not in (select friend_msisdn from tb_chat_friend_user_details_{table_index} where msisdn ='{msisdn}') and ano.msisdn not in (select blocked_msisdn from tb_anonymous_chat_block_user_details_{table_index} where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages_history_{table_index} where msisdn='{msisdn}') and ano.msisdn = sub.msisdn and sub.service ='FB' and ano.operator_id='AIRTEL' and sub.status in ('SUBSCRIBED','GRACE','PENDING') order by ano.id  limit 0 , 4
SQL5_INBOX_MESSAGE_DETAILS =  select *from tb_chat_messages where msisdn='{msisdn}'  and friendMsisdn='{friendMsisdn}'order by chat_date
SQL6_SELECT_GENDER = select gender from tb_anonymous_chat_acc_details_{table_index} where  msisdn='{msisdn}'
SQL7_MYCHAT_USER_ID_INBOX=   select fMsisdn, userId as fUserId, chat_date,DATE_FORMAT(chat_date, "%H:%i")as chatTime, substring(message,1,15) as message from ((select friendUserId as userId,friendMsisdn as fMsisdn,message,chat_date ,id from (select * from tb_chat_messages where msisdn='{msisdn}' order by id desc) as t group by friendMsisdn order by id desc ) UNION (select UserId as userId,msisdn as fMsisdn,message,chat_date,id  from (select * from tb_chat_messages where friendMsisdn='{msisdn}' order by id desc) as t group by msisdn order by id desc)) as p  order by userId,id desc
SQL8_MYCHAT_USER_ID_FROM_HISTORY_TO_OTHERS=select friendMsisdn,friendUserId,substring(message,1,15) as message,chat_read_date,DATE_FORMAT(chat_read_date, "%H:%i") as chatTime from (select *from  tb_chat_messages_history_{table_index} where msisdn='{msisdn}' order by id desc) as t group by friendMsisdn order by id desc
SQL9_MYCHAT_USER_ID_FROM_HISTORY_TO_SELF=select msisdn as fMsisdn,UserId as fUserId,chat_read_date,DATE_FORMAT(chat_read_date, "%H:%i") as chatTime,substring(message,1,15) as message from (select *from  tb_chat_messages_history_{all_table_index} where friendMsisdn='{msisdn}' order by id desc) as t group by msisdn order by id desc
SQL10_CONTACTS_DETAILS =select friend_msisdn as friendMsisdn, friend_userId as friendUserId, Add_friend_date as AddFriendDate,DATE_FORMAT(Add_friend_date, "%H:%i") as AddFriendTime from tb_chat_friend_user_details_{table_index} where msisdn='{msisdn}'
SQL11_GET_USER_ID = select  msisdn as friendMsisdn, userId as friendUserId, gender from tb_anonymous_chat_acc_details_{table_index} where msisdn='{msisdn}'
SQL12_GET_TABLE_INDEX = select table_index from tb_anonymous_chat_username_table_index_mapping where user_id='{userId}'
#SQL13_SEARCH_USER_ID = select ano.msisdn as friendMsidn, ano.userId as friendUserId,ano.gender as gender from tb_anonymous_chat_acc_details_{get_table_index} ano, tb_subscriptions_{get_table_index} sub where ano.msisdn != '{msisdn}'  and ano.msisdn not in (select friend_msisdn from tb_chat_friend_user_details_{get_table_index} where msisdn ='{msisdn}') and ano.msisdn not in (select blocked_msisdn from tb_anonymous_chat_block_user_details_{get_table_index} where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages_history_{get_table_index} where msisdn='{msisdn}') and ano.msisdn = sub.msisdn and userId like '{searchText}%' and sub.service ='FB' and ano.status='Y' and sub.status in ('SUBSCRIBED','GRACE','PENDING') order by ano.id limit 0, 8
SQL13_SEARCH_USER_ID =  select ano.msisdn as friendMsisdn, ano.userId as friendUserId,ano.gender as gender from tb_anonymous_chat_acc_details_{get_table_index} ano  where ano.msisdn != '{msisdn}'  and userId like '{searchText}%' and ano.status='Y' order by ano.id limit 0, 8;
SQL14_USER_PROFILE_INFO= select status,userId,gender from tb_anonymous_chat_acc_details_{table_index} where msisdn='{msisdn}'
#May-20 SQL15_USER_ACCOUNT_INFO= select operator_id,Status,renewal_ts from tb_subscriptions_{table_index} where msisdn='{msisdn}' and service='FB' limit 1
SQL15_USER_ACCOUNT_INFO= select status from gs_subscriber_info where msisdn='{msisdn}'
SQL16_USER_ACCOUNT_CREATE = insert into tb_anonymous_chat_acc_details_{table_index} (msisdn, userId,gender, ageGroup, location, interests, status,operator_id,notification_opt,notification_date,notification_count,activation_date) values ('{msisdn}','{userId}','{gender}','{ageGroup}','','','Y','{operator}','{defaultNotificationOpt}', now(), 0, now());
SQL17_CHECK_MAX_USER_ID = select prefix_name,max_id+1 as maxId from tb_anonymous_chat_user_info where gender ='{gender}' and  operator_id='{operator}' order by max_id limit 1
SQL18_USER_ID_MAPPING = insert into tb_anonymous_chat_username_table_index_mapping (user_id,table_index,operator_id) values('{userId}', '{table_index}','{operator}')
SQL19_UPDATE_MAX_USER_ID = update tb_anonymous_chat_user_info set max_id=max_id+1 where prefix_name='{prefixName}' and operator_id='{operator}'
SQL20_DEFAULT_TODAY_USERID = select ano.userId as todayUserId, ano.msisdn as todayMsisdn from tb_anonymous_chat_acc_details_{table_index} ano, tb_subscriptions_{table_index} sub where ano.msisdn != '{msisdn}' and ano.status='Y' and ano.gender != '{gender}' and  ano.msisdn not in (select friend_msisdn from tb_chat_friend_user_details_{table_index} where msisdn ='{msisdn}') and ano.msisdn not in (select blocked_msisdn from tb_anonymous_chat_block_user_details_{table_index} where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages where msisdn='{msisdn}') and ano.msisdn not in (select friendMsisdn from tb_chat_messages_history_{table_index} where msisdn='{msisdn}') and ano.msisdn = sub.msisdn and sub.service ='FB' and ano.operator_id='AIRTEL' and sub.status in ('SUBSCRIBED','GRACE','PENDING') limit 0 , 4
SQL21_INSERT_CHAT_MESSAGE_INBOX= insert into tb_chat_messages (msisdn,UserId, friendMsisdn,friendUserId,message,operator_id)values('{msisdn}','{userId}','{friendMsisdn}','{friendUserId}','{chatMessage}','{operator}');
SQL22_INSERT_CHAT_MESSAGE_HISTORY= insert into tb_chat_messages_history_{table_index} (msisdn, userId, friendMsisdn,friendUserId, message, chat_read_date,operator_id) values('{msisdn}','{userId}','{friendMsisdn}','{friendUserId}','{chatMessage}',now(),'{operator}');
SQL23_USER_TONE_INFO=select status,calling_party,tone_id from CRBT_SUBS_TONE_PROV_INFO where subscriber_id='{msisdn}' order by tone_type Desc;
SQL24_TONE_PLAYER_DTMF= insert into CRBT_SUBS_TONE_DTMF_INFO (aparty,bparty,tone_id,digits,start_time,end_time,star_to_copy) values ('{aparty}','{bparty}','{tone_id}','{digits}',STR_TO_DATE('{start_time}','%d-%m-%Y %H:%i:%s'),STR_TO_DATE('{end_time}','%d-%m-%Y %H:%i:%s'),'{star_to_copy}');
SQL25_USER_PROFILE_INFO= select subscriber_status,ivr_langId from SUBSCRIBER_PROFILE_DETAILS where subscriber_id='{msisdn}';
SQL26_USER_GIFT_INBOX_CHECK= select gifter_id,tone_id from CRBT_GIFT_INBOX_DETAILS where giftee_id='{msisdn}' and status='Y';
SQL27_INSERT_IVR_LANGUAGE=insert into SUBSCRIBER_PROFILE_DETAILS (subscriber_id,ivr_langId,subscriber_status,ivr_lang_update) values ('{aparty}','{ivrLang}','P',now());
#Changes for CHAT
SQL28_UPDATE_SUB_PROFILE= update SUBSCRIBER_PROFILE_DETAILS set subscriber_status='{sub_status}',activation_date=now() where subscriber_id='{aparty}';
SQL28_UPDATE_CHAT_SUB_PROFILE= update CHAT_SUBSCRIBER_PROFILE set subscriber_status='A',activation_date=now(),blacklist_date=subdate(now(),365) where subscriber_id='{aparty}';
SQL29_UPDATE_IVR_LANGUAGE= update SUBSCRIBER_PROFILE_DETAILS set ivr_langId='{ivrLang}',ivr_lang_update=now() where subscriber_id='{aparty}';
#Changes for CHAT
SQL30_UPDATE_CHAT_UNSUB_PROFILE= update CHAT_SUBSCRIBER_PROFILE set subscriber_status='N',deactivate_date=now() where subscriber_id='{aparty}';
SQL30_UPDATE_UNSUB_PROFILE= update SUBSCRIBER_PROFILE_DETAILS set subscriber_status='{sub_status}',deactivate_date=now() where subscriber_id='{aparty}';
SQL31_CAT_SUB_CAT_SONGS_DETAILS = select tone_id from CRBT_IVR_CATEGORY_INFO where cat_id='{categoryId}' and sub_cat_id='{subCategoryId}';
SQL32_INSERT_TONE_PROV_INFO= insert into CRBT_SUBS_TONE_PROV_INFO (subscriber_id,tone_type,tone_type_idx,STATUS,calling_party,tone_id,song_name,tone_activation_date) values ('{aparty}','{toneType}','{toneTypeIdx}','{status}','{callingParty}','{toneId}','{songName}',now());
SQL32_UPDATE_TONE_PRO_INFO= update CRBT_SUBS_TONE_PROV_INFO set tone_id='{toneId}', calling_party='{callingParty}',song_name='{songName}', tone_activation_date=now() where subscriber_id='{aparty}' and tone_type='{toneType}' and tone_type_idx='{toneTypeIdx}'
SQL33_DELETE_ALL_TONE_INFO = delete from CRBT_SUBS_TONE_PROV_INFO where subscriber_id='{aparty}';
SQL34_INSERT_TP_CDR=insert into CRBT_TP_CDR (subscriber_id,calling_party,play_status,tone_type,tone_id,play_start_time,play_end_time) values ('{bparty}','{aparty}','{playStatus}','{toneType}','{toneId}','{playStartTime}','{playEndTime}');
SQL35_SELECT_SONG_NAME_DETAIL = select songname from contentproperties where songid='{toneId}'; 
SQL36_SELECT_CAT_SUBCAT_DETAILS= select songid,songname from contentproperties where cpcategory1='{categoryId}' and cpcategory2='{subCategoryId}' and contentstatus='PUBLISHED' limit {contentCount};
SQL37_SELECT_LEARN_ENGLISH_CONTENTS= select id,lessonid,path from ivrcontent where categoryid='{categoryId}' and status='A' and lessonid>={lessongId} and activedate <now() order by lessonid, modifydate desc limit 10;
SQL43_INSERT_IVR_CDR=insert into IVR_CDR_DETAILS (aparty,bparty,reason,duration,last_node,call_start,call_end) values ('{aparty}','{bparty}','{reason}',{duration},'{lastNode}','{callStartTime}','{callEndTime}');
SQL44_SELECT_SMS_TEXT= select smstext from ivrcontent where id={smsId};
SQL45_SELECT_IVR_PROMPT= select id, prompt_name,prompt_desc,prompt_path from IVR_PROMPT_DETAILS where service_name='{serviceName}';
SQL46_SELECT_MWOMAN_SUMMARY=select REPORT_DATE, TOTAL_TRAFFIC, TOTAL_UNIQUE_TRAFFIC, MOST_LISTEN_CONTENT_NAME, MOST_LISTEN_CONTENT_CNT, LEAST_LISTEN_CONTENT_NAME, LEAST_LISTEN_CONTENT_CNT, SUB_COUNT from MWOMAN_SUMMARY_REPORT where REPORT_DATE>='{fromDate}' and REPORT_DATE<='{toDate}' order by REPORT_DATE desc;
SQL37_SELECT_QUIZ_CONTENTS=select question_id, prompt_path,answer_key from QUIZ_CONTENT_DETAILS where live_date='{date}' order by modify_date desc;
SQL37_SELECT_QUIZ_CONTENTS_GUI=select ques.id,ques.questionid,ques.answer from tpdb.viva_quiz_question as q, tpdb.quiz as qu, tpdb.question as ques where q.quizid = qu.id and q.questionid = ques.id and qu.startdate = '{date}';
SQL47_QUIZ_IVR_CDR=insert into QUIZ_CDR_DETAILS (aparty,bparty,quiz_cat,quiz_score,quiz_title,quiz_id1,quiz_id2,quiz_id3,quiz_id4,quiz_id5,answer_key1,answer_key2,answer_key3,answer_key4,answer_key5,call_start,call_end,duration,quiz_status) values ('{aparty}','{bparty}','{quizCat}','{quizScore}','{quizTitle}','{quizId1}','{quizId2}','{quizId3}','{quizId4}','{quizId5}','{answerKey1}','{answerKey2}','{answerKey3}','{answerKey4}','{answerKey5}','{callStartTime}','{callEndTime}',{duration},'{quizStatus}');
SQL48_SELECT_CHAT_GROUP_ID= select chat_group_id from CHAT_GROUP_DETAILS where aparty='{aparty}';
SQL48_INSERT_CHAT_GROUP_ID=insert into CHAT_GROUP_DETAILS (aparty,chat_group_id,visited_message_id,group_create_date,last_sms_send) values ('{aparty}','{chatGroupId}',0,now(),now());
SQL48_UPDATE_CHAT_GROUP_ID=update CHAT_GROUP_DETAILS set chat_group_id='{chatGroupId}',visited_message_id=0 where aparty='{aparty}';
SQL48_UPDATE_CHAT_VISIT= update CHAT_GROUP_DETAILS set last_visit_date=now(),visited_message_id={visitedMessageId} where aparty='{aparty}';
SQL48_DELETE_CHAT_GROUP_ID= delete from CHAT_GROUP_DETAILS where aparty='{aparty}';
SQL48_INSERT_CHAT_MESSAGE= insert into CHAT_MESSAGE_DETAILS (subscriber_id,chat_group_id,status,duration,send_date,status_modify_date,recording_path,chat_like,chat_dislike) values ('{subscriberId}','{chatGroupId}','{status}','{duration}',now(),now(),'{recordingPath}',0,0);
SQL48_SELECT_CHAT_MESSAGE=select id,subscriber_id,recording_path from CHAT_MESSAGE_DETAILS where chat_group_id='{chatGroupId}' and status='A' and id<{messageId} order by send_date desc limit {messageCount};
SQL48_UPDATE_CHAT_MESSAGE_LIKE= update CHAT_MESSAGE_DETAILS set chat_like=chat_like+1 where id={id};
SQL48_UPDATE_CHAT_MESSAGE_DISLIKE=update CHAT_MESSAGE_DETAILS set chat_dislike=chat_dislike+1 where id={id};
SQL48_SELECT_CHAT_MESSAGE_DISLIKE= select chat_like,chat_dislike,subscriber_id from CHAT_MESSAGE_DETAILS where id={id};
SQL48_UPDATE_MESSAGE_STATUS= update CHAT_GROUP_WISE_MESSAGE_STATUS set message_count=message_count+1 where chat_group_id='{chatGroupId}';
SQL48_INSERT_BACKLIST_NUMBER= insert into CHAT_BLACKLIST_NUMBER (subscriber_id,user_id) values ('{msisdn}','{userId}');
SQL48_UPDATE_CHAT_MESSAGE_INACTIVE= update CHAT_MESSAGE_DETAILS set status='D' where id={id};
SQL48_SELECT_BACKLIST_NUMBER= select subscriber_id from CHAT_BLACKLIST_NUMBER where subscriber_id='{msisdn}';
SQL48_UPDATE_NOTIFCATION_SMS= update CHAT_GROUP_DETAILS set last_sms_send=now() where aparty='{aparty}';
SQL48_SELECT_SMS_NOTIFICATON=select aparty,chat_group_id from CHAT_GROUP_DETAILS where DATE_add(last_visit_date,INTERVAL {notificationInterval} MINUTE)<now() and DATE_add(last_sms_send,INTERVAL {notificationInterval} MINUTE)<now() and aparty not in (select subscriber_id from CHAT_BLACKLIST_NUMBER);
SQL48_SELECT_CHAT_SUMMARY=select REPORT_DATE, TOTAL_TRAFFIC, TOTAL_UNIQUE_TRAFFIC, TOTAL_BLACKLIST,TOTAL_SUBS,TOTAL_SUBS_SUCCESS,TOTAL_SUBS_FAIL,MOST_LIKE_MSISDN,MOST_JOINED_GROUP  from CHAT_SUMMARY_REPORT where REPORT_DATE>='{fromDate}' and REPORT_DATE<='{toDate}' order by REPORT_DATE desc;
SQL48_SELECT_ALL_BACKLIST_NUMBER= select subscriber_id,user_id,MODIFY_DATE from CHAT_BLACKLIST_NUMBER order by MODIFY_DATE desc limit {startIndex},{endIndex};
SQL48_DELETE_BACKLIST_NUMBER=delete from CHAT_BLACKLIST_NUMBER where subscriber_id='{msisdn}';
SQL48_DELETE_CHAT_MESSAGE=delete from CHAT_MESSAGE_DETAILS where id={messageId};
SQL48_APPROVED_CHAT_MESSAGE= update CHAT_MESSAGE_DETAILS set status='{status}',user_id='{userId}',status_modify_date=now() where id={messageId};
SQL48_SELECT_ALL_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_ALL_GROUP_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where chat_group_id='{chatGroupId}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_ALL_STATUS_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where status='{status}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_ALL_GROUP_STATUS_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where chat_group_id='{chatGroupId}' and status='{status}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_MSISDN_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where subscriber_id='{aparty}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_MSISDN_GROUP_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where subscriber_id='{aparty}' and chat_group_id='{chatGroupId}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_MSISDN_STATUS_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where subscriber_id='{aparty}' and status='{status}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_MSISDN_GROUP_STATUS_CHAT_MESSAGES=select id,subscriber_id,chat_group_id,status,chat_dislike,chat_like,send_date,recording_path from CHAT_MESSAGE_DETAILS where subscriber_id='{aparty}' and status='{status}' and chat_group_id='{chatGroupId}' order by send_date desc limit {startIndex},{endIndex};
SQL48_SELECT_SERVICE_ALLOW=select subscriber_id from IVR_SERVICE_ALLOW_NUMBER where subscriber_id='{aparty}' and service_Id='{serviceId}';
SQL48_CHAT_PROFILE_INFO= select subscriber_status,ivr_langId from CHAT_SUBSCRIBER_PROFILE where subscriber_id='{msisdn}';
SQL48_CHAT_PROFILE_INSERT= INSERT INTO CHAT_SUBSCRIBER_PROFILE (subscriber_id, ivr_langId, subscriber_status, activation_date,blacklist_date) VALUES('{aparty}','IVR','A',now(),subdate(now(),365));
SQL48_CHAT_PROFILE_UPDATE_BLACKLIST= update CHAT_SUBSCRIBER_PROFILE set blacklist_date=now() where subscriber_id='{msisdn}';
SQL48_CHECK_CHAT_PROFILE = select subscriber_id from CHAT_SUBSCRIBER_PROFILE where subscriber_id='{msisdn}' and DATEDIFF(now(),activation_date)>{subscriptioDuration} and DATEDIFF(now(),blacklist_date)>{blackListDuration};
 